{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link 
        href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" 
        rel="stylesheet" 
        integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" 
        crossorigin="anonymous"
    />
    <title>ChartyChat</title>
    <style>
        .logo_chats{
            height: 70px;
        }
        .logo-pos{
            text-align: right;
        }
        .container{
            border: 2px solid black;
            border-radius: 10px;
            display: flex;
            height: auto;
            width: auto;
            flex-direction: row;

        }
        .msg-box{
            height: 87vh;
            border: 2px solid black;
            border-radius: 10px;
        }
        input[type="file"] {
            display: none; 
        }
        .chat-box{
            border: 2px solid black;
            border-radius: 30px;
            width: 150vh;
            height: fit-content;
            align-self: flex-end;
            margin-bottom: 5px;
            padding: 2px;
        }
        .input-cont input{
            width: 100vh;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 30px;
            font-size: 14px;
        }
        .submit-btn, .file-btn,.file-submit-btn {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background-color: #f0f0f0;
            border-radius: 50%;
            border: 1px solid #ccc;
        }
        .submit-btn svg , .file-btn svg, .file-submit-btn svg{
            width: 50px;
            height: 50px;
            color: #000000;
        }
    </style>
    <p class="logo-pos">
        <a href="/home">
            <img class="logo_chats" src="{% static 'home/ChartyChats.png' %}">
        </a>
    </p>
</head>
<body>
    <div class="container">
        <div class="msg-box">
            <!-- Messages will appear here -->
        </div>
        <div class="chat-box">
            <div class="input-box" style="display: flex; align-items: center;">
                <!-- File Upload Form -->
                <form id="file-upload-form" method="POST" enctype="multipart/form-data" style="display: flex; align-items: center; margin-right: 10px;">
                    {% csrf_token %}
                    <label for="file-upload" class="file-btn" style="cursor: pointer;">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-paperclip" viewBox="0 0 16 16">
                            <path d="M4.5 3a2.5 2.5 0 0 1 5 0v9a1.5 1.5 0 0 1-3 0V5a.5.5 0 0 1 1 0v7a.5.5 0 0 0 1 0V3a1.5.5 0 1 0-3 0v9a2.5 2.5 0 0 0 5 0V5a.5.5 0 0 1 1 0v7a3.5 3.5 0 1 1-7 0z"/>
                        </svg>
                    </label>
                    <input type="file" id="file-upload" name="file" style="display: none;" onchange="autoSubmitForm()">
                </form>

                <!-- Chat Input Form -->
                <form method="POST" style="display: flex; align-items: center; width: 100%;">
                    {% csrf_token %}
                    <div class="input-cont" style="flex-grow: 1; margin-right: 10px;">
                        {{ form_chat }}
                    </div>

                    <!-- Chat Message Submit Button -->
                    <button type="submit" class="submit-btn">
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="currentColor" class="bi bi-arrow-up-short" viewBox="0 0 16 16">
                            <path fill-rule="evenodd" d="M8 12a.5.5 0 0 0 .5-.5V5.707l2.146 2.147a.5.5 0 0 0 .708-.708l-3-3a.5.5 0 0 0-.708 0l-3 3a.5.5 0 1 0 .708.708L7.5 5.707V11.5a.5.5 0 0 0 .5.5"/>
                        </svg>
                    </button>
                </form>
            </div>
        </div>
    </div>

    {% if response %}
        <p>You submitted: {{ response }}</p>
    {% endif %}

    <script>
        function autoSubmitForm() {
            const fileInput = document.getElementById('file-upload');
            if (fileInput.files.length > 0) {
                document.getElementById('file-upload-form').submit();
            }
        }
    </script>
</body>



